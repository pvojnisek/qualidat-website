<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 U16 Boys Water Polo US Club Championship</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Floating Back Button -->
    <a href="index.html" class="floating-back-btn" id="floatingBackBtn">
        <img src="images/logo.png" alt="SD Shores Logo" />
    </a>
    <div class="hero">
        <h1>üèÜ 2025 U16 Boys Water Polo</h1>
        <p class="subtitle">US Club Championship</p>
        <div class="memorial">
            <p><strong>June 20-22, 2025</strong></p>
            <p><a href="pools.html#riverside-poly">Riverside Poly</a> ‚Ä¢ <a href="pools.html#ramona">Ramona HS</a> ‚Ä¢ <a href="pools.html#norco">Norco HS</a> ‚Ä¢ <a href="pools.html#chino-hills">Chino Hills HS</a></p>
        </div>
    </div>

    <div class="container">

        <!-- Tournament Information -->
        <div class="content-section">
            <button class="collapsible">üìã Tournament Information</button>
            <div class="collapsible-content">
                <div class="tournament-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="team-count">16</div>
                        <div class="stat-label">Teams</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="match-count">39</div>
                        <div class="stat-label">Matches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="venue-count">4</div>
                        <div class="stat-label">Venues</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3</div>
                        <div class="stat-label">Days</div>
                    </div>
                </div>
                <div class="memorial-story">
                    <h3>üèÜ US Club Championship Tournament</h3>
                    <p>The premier 16U Boys Water Polo championship tournament featuring 16 elite teams competing across four pools (A, B, C, D) in a comprehensive bracket format. Teams advance through pool play into crossover elimination rounds, culminating in placement matches that determine final tournament standings.</p>
                    <p>This prestigious tournament showcases the finest youth water polo talent from across the region, with matches held at premier aquatic facilities throughout Southern California over three competitive days.</p>
                </div>
            </div>
        </div>

        <!-- Final Tournament Standings -->
        <div class="content-section">
            <button class="collapsible active">üèÜ Final Tournament Standings</button>
            <div class="collapsible-content active">
                <div style="overflow-x: auto; margin-top: 20px;">
                    <table id="standings-table" style="width: 100%; border-collapse: collapse; font-size: 0.9rem; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #0077be 0%, #00a8cc 100%); color: white;">
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Rank</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: left; font-weight: bold;">Team</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; cursor: help; position: relative;" data-tooltip="Games Played - Total number of matches played in the tournament">GP</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; cursor: help; position: relative;" data-tooltip="Goals For - Total goals scored by the team">GF</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; cursor: help; position: relative;" data-tooltip="Goals Against - Total goals conceded by the team">GA</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; cursor: help; position: relative;" data-tooltip="Goal Difference - Goals For minus Goals Against (GF - GA)">GD</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Final Result</th>
                            </tr>
                        </thead>
                        <tbody id="standings-tbody">
                            <!-- Standings will be populated here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Custom tooltip styles for table headers -->
                <style>
                    [data-tooltip] {
                        position: relative;
                    }
                    
                    [data-tooltip]:hover::after {
                        content: attr(data-tooltip);
                        position: absolute;
                        bottom: 125%;
                        left: 50%;
                        transform: translateX(-50%);
                        background: rgba(0, 0, 0, 0.9);
                        color: white;
                        padding: 8px 12px;
                        border-radius: 4px;
                        font-size: 0.8rem;
                        white-space: nowrap;
                        z-index: 1000;
                        font-weight: normal;
                    }
                    
                    [data-tooltip]:hover::before {
                        content: '';
                        position: absolute;
                        bottom: 115%;
                        left: 50%;
                        transform: translateX(-50%);
                        border: 5px solid transparent;
                        border-top-color: rgba(0, 0, 0, 0.9);
                        z-index: 1000;
                    }
                </style>
            </div>
        </div>

        <div id="loading" class="loading" style="display: none;">
            üèä‚Äç‚ôÇÔ∏è Loading tournament data...
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <!-- Pools Section -->
        <div class="content-section">
            <div class="section-header">üèä‚Äç‚ôÇÔ∏è Tournament Pools</div>
            <div class="section-content">
                <div class="standings-grid" id="pools-container">
                    <!-- Pools will be populated here -->
                </div>
            </div>
        </div>

        <!-- All Tournament Matches -->
        <div class="content-section">
            <div class="section-header">üìÖ All Tournament Matches - Complete Schedule</div>
            <div class="section-content">
                <div style="overflow-x: auto; margin-top: 20px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #0077be 0%, #00a8cc 100%); color: white;">
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Game</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Date</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Time</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Venue</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Team 1</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Score</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Team 2</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Phase/Bracket</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Status</th>
                                <th style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Videos</th>
                            </tr>
                        </thead>
                        <tbody id="matches-tbody">
                            <!-- Matches will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Data Source -->
        <div class="content-section">
            <div class="section-content">
                <div class="data-source">
                    <h4>üìä Data Source</h4>
                    <p>Tournament schedules, results and live match updates from official scoresheet:</p>
                    <a href="https://docs.google.com/spreadsheets/d/1FuCUomKqgfg8d83zYxld0B2mnTmcbefwyxKFEebMgiY/edit?gid=0#gid=0" target="_blank" rel="noopener noreferrer">
                        View Official Tournament Scoresheet - US Club Championship 16U
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <p><strong>2025 U16 Boys Water Polo - US Club Championship</strong></p>
            <p>June 20-22, 2025 ‚Ä¢ <a href="pools.html#riverside-poly">Riverside Poly</a> ‚Ä¢ <a href="pools.html#ramona">Ramona HS</a> ‚Ä¢ <a href="pools.html#norco">Norco HS</a> ‚Ä¢ <a href="pools.html#chino-hills">Chino Hills HS</a> ‚Ä¢ California</p>
            <p>Building champions through competition and teamwork üèÜ</p>
        </div>
    </div>

    <script>
        // Tournament data (embedded to work within CSP constraints)
        // To connect to live Google Sheets, replace this with:
        // const CSV_URL = 'https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/export?format=csv&gid=0';
        // and use fetch(CSV_URL) in loadTournamentData()
        
        const csvData = `DATE,LOCATION,TIME,WHITE TEAM,S,DARK TEAM,S,COMMENTS
6/20/2025,RIVERSIDE POLY #1,4:30 PM,D1 - THUNDER,10,D4 - KERN PREMIER,11,bracket
6/20/2025,RIVERSIDE POLY #1,5:30 PM,B2 - ROSE BOWL,8,B3 -  SD SHORES GOLD,14,bracket
6/20/2025,RIVERSIDE POLY #1,6:30 PM,C1 - CARLSBAD,8,C3 - CLOVIS,14,bracket
6/20/2025,RIVERSIDE POLY #1,7:30 PM,D2 - COMMERCE,14,D4 - KERN PREMIER,9,bracket
6/20/2025,RAMONA HS,4:30 PM,D2 - COMMERCE,8,D3 - SUPREME,12,bracket
6/20/2025,RAMONA HS,5:30 PM,A2 - POWAY VALLEY,9,A3 - SOCAL,12,bracket
6/20/2025,RAMONA HS,6:30 PM,C2 - CHAWP,10,C4 - TEMPLE CITY,4,bracket
6/20/2025,RAMONA HS,7:30 PM,D1 - THUNDER,13,D3 - SUPREME,14,bracket
6/20/2025,NORCO HS,10:00 AM,C1 - CARLSBAD,10,C4 - TEMPLE CITY,12,bracket
6/20/2025,NORCO HS,11:00 AM,C2 - CHAWP,8,C3 - CLOVIS,6,bracket
6/21/2025,RIVERSIDE POLY #1,9:00 AM,A1 - SD SHORES BLACK,18,A2 - POWAY VALLEY,9,
6/21/2025,RIVERSIDE POLY #1,11:00 AM,A1 - SD SHORES BLACK,18,A3 - SOCAL,6,
6/21/2025,RIVERSIDE POLY #1,12:00 PM,C1 - CARLSBAD,4,C2 - CHAWP,14,
6/21/2025,RIVERSIDE POLY #1,1:00 PM,C3 - CLOVIS,11,C4 - TEMPLE CITY,8,
6/21/2025,RIVERSIDE POLY #1,2:00 PM,E1 -1st A - SD SHORES BLACK,15,E2 - 2nd B - ROSE BOWL,5,
6/21/2025,RIVERSIDE POLY #1,3:00 PM,K1- 3rd B - NORTH IRVINE,15,K3 - 4th D - THUNDER,9,
6/21/2025,RIVERSIDE POLY #1,4:00 PM,H1 - 1st D - SUPREME,8,H2 - 2nd C - CLOVIS,9,
6/21/2025,RIVERSIDE POLY #1,5:00 PM,K1- 3rd B - NORTH IRVINE,18,K2 - 3rd C - TEMPLE CITY,15,
6/21/2025,RAMONA HS,9:00 AM,B1 - NORTH IRVINE,6,B3 -  SD SHORES GOLD,14,
6/21/2025,RAMONA HS,11:00 AM,B1 - NORTH IRVINE,7,B2 - ROSE BOWL,10,
6/21/2025,RAMONA HS,12:00 PM,D3 - SUPREME,12,D4 - KERN PREMIER,7,
6/21/2025,RAMONA HS,1:00 PM,D1 - THUNDER,9,D2 - COMMERCE,15,
6/21/2025,RAMONA HS,2:00 PM,F1 -1st B - SD SHORES GOLD,11,F2 -2nd A - SOCAL,14,
6/21/2025,RAMONA HS,3:00 PM,J1- 3rd A - POWAY VALLEY,20,J2 - 3rd D -  KERN PREMIER,6,
6/21/2025,RAMONA HS,4:00 PM,G1 - 1st C - CHAWP,12,G2 - 2nd D - COMMERCE,8,
6/21/2025,RAMONA HS,5:00 PM,J1- 3rd A - POWAY VALLEY,14,J3 - 4th C - CARLSBAD,6,
6/22/2025,RIVERSIDE POLY #1,8:00 AM,M1 - 1st E - SD SHORES BLACK,18,M2 - 1st H - CLOVIS,3,
6/22/2025,RIVERSIDE POLY #1,9:00 AM,N1 - 1st F - SOCAL,8,N2 - 1st G - CHAWP,4,
6/22/2025,RIVERSIDE POLY #1,11:00 AM,P1 - 2nd F - SD SHORES GOLD,5,P2 - 2nd G - COMMERCE,0,
6/22/2025,RIVERSIDE POLY #1,12:00 PM,O1 - 2nd E - ROSE BOWL,12,O2 - 2nd H - SUPREME,10,
6/22/2025,RIVERSIDE POLY #1,2:00 PM,X1 - 2nd O - SUPREME,7,X2 - 2nd P - COMMERCE,15,7th
6/22/2025,RIVERSIDE POLY #1,3:00 PM,W1 - 1st O - ROSE BOWL,13,W2 - 1st P - SD SHORES GOLD,12,5th
6/22/2025,RAMONA HS,8:00 AM,K2 - 3rd C - TEMPLE CITY,10,K3 - 4th D - THUNDER,11,
6/22/2025,RAMONA HS,9:00 AM,J2 - 3rd D -  KERN PREMIER,15,J3 - 4th C - CARLSBAD,9,
6/22/2025,RAMONA HS,11:00 AM,R1 - 3rd J - CARSBAD,10,R2 - 3rd K - TEMPLE CITY,14,13th
6/22/2025,RAMONA HS,12:00 PM,Q1 - 1st J -  POWAY VALLEY,16,Q2 - 1st K - NORTH IRVINE,2,9th
6/22/2025,RAMONA HS,2:00 PM,S1 - 2nd J - TEMPLE CITY,13,S2 - 2nd K - THUNDER,10,11th
6/22/2025,CHINO HILLS HS,1:00 PM,V1 - 2nd M -CLOVIS,8,V2 - 2nd N - CHAWP,12,3rd
6/22/2025,CHINO HILLS HS,2:00 PM,U1 - 1st M - SD SHORES BLACK,14,U2 - 1st N - SOCAL,5,1st`;
        
        let tournamentData = {};


        // Parse CSV data
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = parseCSVLine(lines[i]);
                    if (values.length >= headers.length) {
                        const row = {};
                        headers.forEach((header, index) => {
                            // Handle duplicate 'S' column names by making them unique
                            if (header === 'S' && row.hasOwnProperty('S')) {
                                row['S2'] = values[index] || '';
                            } else {
                                row[header] = values[index] || '';
                            }
                        });
                        data.push(row);
                    }
                }
            }
            return data;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"' && (i === 0 || line[i-1] === ',')) {
                    inQuotes = true;
                } else if (char === '"' && inQuotes) {
                    inQuotes = false;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        // Clean team name (extract code and name)
        function cleanTeamName(teamName) {
            if (!teamName || teamName.trim() === '') {
                return { code: "", name: "" };
            }
            
            const match = teamName.trim().match(/^([A-Z0-9]+(?:\s*-\s*\w+)*)\s*-\s*(.+)$/);
            if (match) {
                return { code: match[1].trim(), name: match[2].trim().replace(/\s+/g, ' ') };
            }
            return { code: "", name: teamName.trim() };
        }

        // Determine match phase
        function determineMatchPhase(comments, whiteTeam, darkTeam) {
            const commentsLower = comments.toLowerCase();
            if (commentsLower.includes('bracket')) return "Pool Play";
            if (['1st', '2nd', '3rd', '4th'].some(term => commentsLower.includes(term))) return "Crossover";
            if (commentsLower.includes('final') || ['1st', '3rd', '5th', '7th', '9th', '11th', '13th', '15th'].some(term => comments.includes(term))) return "Finals";
            if (['A1', 'A2', 'A3', 'A4', 'B1', 'B2', 'B3', 'B4', 'C1', 'C2', 'C3', 'C4', 'D1', 'D2', 'D3', 'D4'].some(code => 
                whiteTeam.includes(code) || darkTeam.includes(code))) return "Pool Play";
            return "Bracket Play";
        }

        // Process tournament data
        function processTournamentData(csvData) {
            const matches = [];
            const allTeams = new Set();
            const venues = new Set();

            csvData.forEach((row, index) => {
                if (!row.DATE || row.DATE.trim() === '' || row.DATE.includes('DATE')) return;
                
                const whiteTeamRaw = (row['WHITE TEAM'] || '').trim();
                const darkTeamRaw = (row['DARK TEAM'] || '').trim();
                if (!whiteTeamRaw || !darkTeamRaw) return;
                
                const whiteTeam = cleanTeamName(whiteTeamRaw);
                const darkTeam = cleanTeamName(darkTeamRaw);
                
                allTeams.add(whiteTeam.name);
                allTeams.add(darkTeam.name);
                venues.add((row.LOCATION || '').trim());
                
                // Parse scores from the S columns (S = white team score, S2 = dark team score)
                const whiteScore = (row.S && row.S.trim() !== '') ? parseInt(row.S.trim()) : null;
                const darkScore = (row.S2 && row.S2.trim() !== '') ? parseInt(row.S2.trim()) : null;
                
                const match = {
                    match_id: index + 1,
                    date: (row.DATE || '').trim(),
                    time: (row.TIME || '').trim(),
                    venue: (row.LOCATION || '').trim(),
                    white_team: whiteTeam,
                    dark_team: darkTeam,
                    white_score: whiteScore,
                    dark_score: darkScore,
                    status: (whiteScore !== null && darkScore !== null) ? 'COMPLETED' : 'SCHEDULED',
                    phase: determineMatchPhase(row.COMMENTS || '', whiteTeamRaw, darkTeamRaw),
                    comments: (row.COMMENTS || '').trim()
                };
                
                // Add videos for specific matches
                match.videos = getVideosForMatch(whiteTeam.name, darkTeam.name, whiteScore, darkScore);
                
                matches.push(match);
            });

            // Filter actual teams (remove placeholders)
            const actualTeams = Array.from(allTeams).filter(team => 
                !team.includes('st ') && !team.endsWith(' -') && team !== ''
            );

            // Extract pools based on actual tournament structure from CSV data
            const pools = {
                A: ['SD SHORES BLACK', 'POWAY VALLEY', 'SOCAL'],
                B: ['NORTH IRVINE', 'ROSE BOWL', 'SD SHORES GOLD'], 
                C: ['CARLSBAD', 'CHAWP', 'CLOVIS', 'TEMPLE CITY'],
                D: ['THUNDER', 'COMMERCE', 'SUPREME', 'KERN PREMIER']
            };

            return {
                teams: actualTeams.sort(),
                venues: Array.from(venues).filter(v => v).sort(),
                pools: pools,
                matches: matches
            };
        }

        // Display pools
        function displayPools(pools) {
            const container = document.getElementById('pools-container');
            container.innerHTML = '';

            Object.entries(pools).forEach(([poolName, teams]) => {
                if (teams.length > 0) {
                    const standingsTable = document.createElement('div');
                    standingsTable.className = 'standings-table';
                    
                    standingsTable.innerHTML = `
                        <h3>Pool ${poolName}</h3>
                        <div class="standings-list">
                            ${teams.map((team, index) => `
                                <div class="standing-item clickable-pool-team" data-team="${team}" style="cursor: pointer; transition: background-color 0.2s;">
                                    <span class="position">${poolName}${index + 1}</span>
                                    <span class="team-name">${team}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    container.appendChild(standingsTable);
                }
            });
        }

        // Display matches in table format
        function displayMatches(matches) {
            const tbody = document.getElementById('matches-tbody');
            tbody.innerHTML = '';

            // Sort matches by match_id to show in chronological order
            matches.sort((a, b) => a.match_id - b.match_id);

            matches.forEach(match => {
                const row = document.createElement('tr');
                
                // Determine status color
                let statusColor = '#1976d2'; // Blue for scheduled
                let statusText = 'SCHEDULED';
                if (match.status === 'COMPLETED') {
                    statusColor = '#388e3c'; // Green for completed
                    statusText = 'COMPLETED';
                } else if (match.phase.toLowerCase().includes('final')) {
                    statusColor = '#d32f2f'; // Red for finals
                }

                // Determine if teams are placeholders
                const isPlaceholder = match.white_team.name.includes(' -') || match.dark_team.name.includes(' -');
                
                // Determine winner and format team names
                let whiteTeamStyle = `padding: 8px; border: 1px solid #ddd; text-align: left; ${isPlaceholder ? 'font-style: italic; color: #666;' : ''}`;
                let darkTeamStyle = `padding: 8px; border: 1px solid #ddd; text-align: left; ${isPlaceholder ? 'font-style: italic; color: #666;' : ''}`;
                
                if (match.status === 'COMPLETED' && match.white_score !== null && match.dark_score !== null) {
                    if (match.white_score > match.dark_score) {
                        // White team wins - make bold
                        whiteTeamStyle += '; font-weight: bold; color: #2e7d32;';
                    } else if (match.dark_score > match.white_score) {
                        // Dark team wins - make bold
                        darkTeamStyle += '; font-weight: bold; color: #2e7d32;';
                    }
                }
                
                // Format score display
                let scoreDisplay = '- vs -';
                if (match.status === 'COMPLETED' && match.white_score !== null && match.dark_score !== null) {
                    scoreDisplay = `<span style="font-weight: bold; color: #d32f2f;">${match.white_score}</span> - <span style="font-weight: bold; color: #d32f2f;">${match.dark_score}</span>`;
                }
                
                // Format videos display
                let videosDisplay = '-';
                if (match.videos && match.videos.length > 0) {
                    videosDisplay = match.videos.map(video => 
                        `<a href="${video.url}" target="_blank" rel="noopener noreferrer" 
                           style="display: inline-block; background: #dc2626; color: white; padding: 4px 8px; 
                                  margin: 2px; border-radius: 4px; text-decoration: none; font-size: 0.8rem; 
                                  font-weight: bold; transition: background 0.2s;" 
                           onmouseover="this.style.background='#b91c1c'" 
                           onmouseout="this.style.background='#dc2626'" 
                           title="${video.title}">${video.quarter}</a>`
                    ).join('');
                }
                
                row.innerHTML = `
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${match.match_id}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${match.date}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;" id="time-cell-${match.match_id}">
                        <!-- Calendar button will be inserted here -->
                    </td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${getVenueLink(match.venue)}</td>
                    <td style="${whiteTeamStyle}">${match.white_team.code ? match.white_team.code + ' - ' : ''}${match.white_team.name}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; font-size: 1.1rem;">${scoreDisplay}</td>
                    <td style="${darkTeamStyle}">${match.dark_team.code ? match.dark_team.code + ' - ' : ''}${match.dark_team.name}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center; background: #f8f9ff; color: #0077be; font-weight: 500;">${match.phase}</td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">
                        <span style="display: inline-block; width: 8px; height: 8px; background: ${statusColor}; border-radius: 50%; margin-right: 6px;"></span>
                        <span style="font-size: 0.9rem; color: ${statusColor};">${statusText}</span>
                    </td>
                    <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">${videosDisplay}</td>
                `;

                // Highlight key matches
                if (match.comments && (match.comments.includes('1st') || match.comments.includes('3rd') || match.comments.includes('5th'))) {
                    row.style.background = 'linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)';
                    row.style.border = '2px solid #f39c12';
                }

                // Highlight San Diego Shores teams
                if (match.white_team.name.includes('SHORES') || match.dark_team.name.includes('SHORES')) {
                    row.style.background = 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)';
                    row.style.border = '2px solid #2196f3';
                }

                tbody.appendChild(row);
                
                // Add calendar button after row is added to DOM
                const timeCell = document.getElementById(`time-cell-${match.match_id}`);
                if (timeCell) {
                    // Format match data for calendar function
                    const calendarMatchData = {
                        date: match.date,
                        time: match.time,
                        venue: match.venue,
                        team1: match.white_team.name,
                        team2: match.dark_team.name,
                        game_number: match.match_id
                    };
                    
                    const calendarButton = createCalendarButton(calendarMatchData, {
                        tournamentName: 'US Club Championship 16U',
                        websiteSource: 'SD Shores Tournament Website'
                    });
                    timeCell.appendChild(calendarButton);
                }
            });
        }

        // Calculate team statistics (GP, GF, GA, GD) using proper team name matching
        function calculateTeamStatistics(matches) {
            const teamStats = {};
            
            // Get all team names from standings to properly initialize stats
            const allTeamNames = [
                'SD SHORES BLACK', 'SOCAL', 'CHAWP', 'CLOVIS', 'ROSE BOWL', 'SD SHORES GOLD',
                'COMMERCE', 'SUPREME', 'POWAY VALLEY', 'NORTH IRVINE', 'TEMPLE CITY', 
                'THUNDER', 'CARLSBAD', 'KERN PREMIER'
            ];
            
            // Initialize all team stats
            allTeamNames.forEach(teamName => {
                teamStats[teamName] = { gp: 0, gf: 0, ga: 0, gd: 0 };
            });
            
            matches.forEach(match => {
                const whiteTeamName = match.white_team.name.replace(/\s+/g, ' ').trim();
                const darkTeamName = match.dark_team.name.replace(/\s+/g, ' ').trim();
                const whiteScore = match.white_score;
                const darkScore = match.dark_score;
                
                // Only count completed matches (both scores are not null)
                if (match.status === 'COMPLETED' && whiteScore !== null && darkScore !== null) {
                    // Find matching team names using same logic as showPoolTeamMatches
                    allTeamNames.forEach(teamName => {
                        const searchTeamName = teamName.replace(/\s+/g, ' ').trim();
                        
                        // Check if this team is the white team
                        if (whiteTeamName.endsWith(searchTeamName) || whiteTeamName === searchTeamName) {
                            teamStats[teamName].gp++;
                            teamStats[teamName].gf += whiteScore;
                            teamStats[teamName].ga += darkScore;
                            teamStats[teamName].gd = teamStats[teamName].gf - teamStats[teamName].ga;
                        }
                        
                        // Check if this team is the dark team  
                        if (darkTeamName.endsWith(searchTeamName) || darkTeamName === searchTeamName) {
                            teamStats[teamName].gp++;
                            teamStats[teamName].gf += darkScore;
                            teamStats[teamName].ga += whiteScore;
                            teamStats[teamName].gd = teamStats[teamName].gf - teamStats[teamName].ga;
                        }
                    });
                }
            });
            
            return teamStats;
        }

        // Determine final standings order based on placement matches
        function determineFinalStandings(matches) {
            const finalStandings = [];
            
            // Define final standings based on placement match results
            const standingsOrder = [
                { rank: 1, team: 'SD SHORES BLACK', result: 'ü•á Champion' },
                { rank: 2, team: 'SOCAL', result: 'ü•à Championship Final Runner-up' },
                { rank: 3, team: 'CHAWP', result: 'ü•â 3rd Place Match Winner' },
                { rank: 4, team: 'CLOVIS', result: '4th Place' },
                { rank: 5, team: 'ROSE BOWL', result: '5th Place Match Winner' },
                { rank: 6, team: 'SD SHORES GOLD', result: '6th Place' },
                { rank: 7, team: 'COMMERCE', result: '7th Place Match Winner' },
                { rank: 8, team: 'SUPREME', result: '8th Place' },
                { rank: 9, team: 'POWAY VALLEY', result: '9th Place Match Winner' },
                { rank: 10, team: 'NORTH IRVINE', result: '10th Place' },
                { rank: 11, team: 'TEMPLE CITY', result: '11th Place Match Winner' },
                { rank: 12, team: 'THUNDER', result: '12th Place' },
                { rank: 13, team: 'CARLSBAD', result: '13th Place' },
                { rank: 14, team: 'KERN PREMIER', result: '14th Place' }
            ];
            
            return standingsOrder;
        }

        // Display final standings table
        function displayFinalStandings(matches) {
            const teamStats = calculateTeamStatistics(matches);
            const standings = determineFinalStandings(matches);
            const tbody = document.getElementById('standings-tbody');
            tbody.innerHTML = '';
            
            standings.forEach(standing => {
                const stats = teamStats[standing.team] || { gp: 0, gf: 0, ga: 0, gd: 0 };
                const row = document.createElement('tr');
                row.style.cursor = 'pointer';
                row.style.transition = 'background-color 0.2s';
                row.className = 'clickable-standings-team';
                row.setAttribute('data-team', standing.team);
                
                // Add hover effect
                row.addEventListener('mouseenter', function() {
                    this.style.backgroundColor = '#f0f8ff';
                });
                row.addEventListener('mouseleave', function() {
                    this.style.backgroundColor = '';
                });
                
                // Add click handler for team details
                row.addEventListener('click', function() {
                    showPoolTeamMatches(standing.team);
                });
                
                // Medal emoji for top 3
                let rankDisplay = standing.rank;
                if (standing.rank === 1) rankDisplay = 'ü•á 1';
                else if (standing.rank === 2) rankDisplay = 'ü•à 2';
                else if (standing.rank === 3) rankDisplay = 'ü•â 3';
                
                // Goal difference with + sign for positive
                const gdDisplay = stats.gd > 0 ? `+${stats.gd}` : stats.gd.toString();
                
                row.innerHTML = `
                    <td style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${rankDisplay}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; font-weight: bold;">${standing.team}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">${stats.gp}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">${stats.gf}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; text-align: center;">${stats.ga}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; text-align: center; font-weight: bold; color: ${stats.gd > 0 ? '#28a745' : stats.gd < 0 ? '#dc3545' : '#666'};">${gdDisplay}</td>
                    <td style="padding: 12px 8px; border: 1px solid #ddd; font-size: 0.85rem; color: #666;">${standing.result}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Load and display tournament data
        function loadTournamentData() {
            try {
                const csvRows = parseCSV(csvData);
                tournamentData = processTournamentData(csvRows);
                
                // Update stats
                document.getElementById('team-count').textContent = tournamentData.teams.length;
                document.getElementById('match-count').textContent = tournamentData.matches.length;
                document.getElementById('venue-count').textContent = tournamentData.venues.length;
                
                // Display data
                displayPools(tournamentData.pools);
                displayMatches(tournamentData.matches);
                displayFinalStandings(tournamentData.matches);
                
            } catch (error) {
                console.error('Error loading tournament data:', error);
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').textContent = `Error loading tournament data: ${error.message}`;
            }
        }

        // Function to get videos for specific matches
        function getVideosForMatch(whiteTeamName, darkTeamName, whiteScore, darkScore) {
            const videos = [];
            
            // Debug logging for all SD SHORES BLACK matches
            if (whiteTeamName.includes('SD SHORES BLACK') || darkTeamName.includes('SD SHORES BLACK')) {
                console.log(`SD SHORES BLACK match debug: white="${whiteTeamName}", dark="${darkTeamName}", scores=${whiteScore}-${darkScore}`);
            }
            
            // Check for SD SHORES BLACK vs POWAY VALLEY (18-9 in CSV data)
            if ((whiteTeamName === 'SD SHORES BLACK' && darkTeamName === 'POWAY VALLEY' && whiteScore === 18 && darkScore === 9) ||
                (darkTeamName === 'SD SHORES BLACK' && whiteTeamName === 'POWAY VALLEY' && darkScore === 18 && whiteScore === 9)) {
                return [
                    { quarter: 'Q1', url: 'https://youtu.be/JA0L441qIh4?si=teWOCvyAZU-HSHjR', title: 'SD Shores Black vs Poway - Q1' },
                    { quarter: 'Q2', url: 'https://youtu.be/3S6pzcupvuo?si=D2rq-R2MpajvXblL', title: 'SD Shores Black vs Poway - Q2' },
                    { quarter: 'Q3', url: 'https://youtu.be/fR-OGEkA8cs?si=QrmmOPv0uKiBpCii', title: 'SD Shores Black vs Poway - Q3' },
                    { quarter: 'Q4', url: 'https://youtu.be/zjGfjimQKYk?si=9mXkM8cvd-6AAhbw', title: 'SD Shores Black vs Poway - Q4' }
                ];
            }
            
            // Check for SD SHORES BLACK vs SOCAL (18-6)
            if ((whiteTeamName === 'SD SHORES BLACK' && darkTeamName === 'SOCAL' && whiteScore === 18 && darkScore === 6) ||
                (darkTeamName === 'SD SHORES BLACK' && whiteTeamName === 'SOCAL' && darkScore === 18 && whiteScore === 6)) {
                return [
                    { quarter: 'Q1', url: 'https://youtu.be/zVWixJ6B2Q0?si=zHe4Wj1JNosDEQeg', title: 'SD Shores Black vs SoCal - Q1' },
                    { quarter: 'Q2', url: 'https://youtu.be/xYBHHMzZ628?si=dD_Ss7Bv_s3oOtWR', title: 'SD Shores Black vs SoCal - Q2' },
                    { quarter: 'Q3', url: 'https://youtu.be/2n7yz1rStEY?si=hgdMuIZXhxD6sus-', title: 'SD Shores Black vs SoCal - Q3' },
                    { quarter: 'Q4', url: 'https://youtu.be/x5sEmWxHAU0?si=8X-StZoF0ENCEByB', title: 'SD Shores Black vs SoCal - Q4' }
                ];
            }
            
            // Check for SD SHORES BLACK vs ROSE BOWL (15-5) - with more flexible matching
            if (((whiteTeamName === 'SD SHORES BLACK' || whiteTeamName.includes('SD SHORES BLACK')) && 
                 (darkTeamName === 'ROSE BOWL' || darkTeamName.includes('ROSE BOWL')) && 
                 whiteScore === 15 && darkScore === 5) ||
                ((darkTeamName === 'SD SHORES BLACK' || darkTeamName.includes('SD SHORES BLACK')) && 
                 (whiteTeamName === 'ROSE BOWL' || whiteTeamName.includes('ROSE BOWL')) && 
                 darkScore === 15 && whiteScore === 5)) {
                return [
                    { quarter: 'Q1', url: 'https://youtu.be/wufkmEzIBsc?si=I_fSWQHj8XG1pb_t', title: 'SD Shores Black vs Rose Bowl - Q1' },
                    { quarter: 'Q2', url: 'https://youtu.be/WK7UYbZDWKI?si=ZWXLf1DNgbdN5iiK', title: 'SD Shores Black vs Rose Bowl - Q2' },
                    { quarter: 'Q3', url: 'https://youtu.be/mnlL4itpzEM?si=FU8_a0hx_0vu0v9u', title: 'SD Shores Black vs Rose Bowl - Q3' },
                    { quarter: 'Q4', url: 'https://youtu.be/LHRjW8jjarY?si=PoKkEgInqVfrHGM3', title: 'SD Shores Black vs Rose Bowl - Q4' }
                ];
            }
            
            // Check for SD SHORES BLACK vs CLOVIS (18-3) - with more flexible matching
            if (((whiteTeamName === 'SD SHORES BLACK' || whiteTeamName.includes('SD SHORES BLACK')) && 
                 (darkTeamName === 'CLOVIS' || darkTeamName.includes('CLOVIS')) && 
                 whiteScore === 18 && darkScore === 3) ||
                ((darkTeamName === 'SD SHORES BLACK' || darkTeamName.includes('SD SHORES BLACK')) && 
                 (whiteTeamName === 'CLOVIS' || whiteTeamName.includes('CLOVIS')) && 
                 darkScore === 18 && whiteScore === 3)) {
                return [
                    { quarter: 'Q1', url: 'https://youtu.be/q4ZNwVTJN5o?si=N2V0gDHpBXSFy5Xj', title: 'SD Shores Black vs Clovis - Q1' },
                    { quarter: 'Q2', url: 'https://youtu.be/D5ns83BK2Ag?si=SbakkhkJrUqpolG2', title: 'SD Shores Black vs Clovis - Q2' },
                    { quarter: 'Q3', url: 'https://youtu.be/-I76I6ksyfA?si=kOjXF5So6BbxzE6Z', title: 'SD Shores Black vs Clovis - Q3' },
                    { quarter: 'Q4', url: 'https://youtu.be/v2YjF9Gii34?si=SxV-P0Gf3hLikcp4', title: 'SD Shores Black vs Clovis - Q4' }
                ];
            }
            
            // Check for second SD SHORES BLACK vs SOCAL match (14-5) - with more flexible matching
            if (((whiteTeamName === 'SD SHORES BLACK' || whiteTeamName.includes('SD SHORES BLACK')) && 
                 (darkTeamName === 'SOCAL' || darkTeamName.includes('SOCAL')) && 
                 whiteScore === 14 && darkScore === 5) ||
                ((darkTeamName === 'SD SHORES BLACK' || darkTeamName.includes('SD SHORES BLACK')) && 
                 (whiteTeamName === 'SOCAL' || whiteTeamName.includes('SOCAL')) && 
                 darkScore === 14 && whiteScore === 5)) {
                return [
                    { quarter: 'Q1', url: 'https://youtu.be/d8GzqfVqxxY?si=pLv0tVxCPF_W0kxh', title: 'SD Shores Black vs SoCal - Q1' },
                    { quarter: 'Q2', url: 'https://youtu.be/RUYXkTnuyEg?si=OqTFyaOKvQTdLfXO', title: 'SD Shores Black vs SoCal - Q2' },
                    { quarter: 'Q3', url: 'https://youtu.be/RUYXkTnuyEg?si=mC2C3cZX_AhL2cBf', title: 'SD Shores Black vs SoCal - Q3' },
                    { quarter: 'Q4', url: 'https://youtu.be/42ABPbSGc-o?si=dHR-pq4wgk8NoNOE', title: 'SD Shores Black vs SoCal - Q4' }
                ];
            }
            
            return [];
        }
        
        // Function to convert venue names to links
        function getVenueLink(venue) {
            const venueLinks = {
                'RIVERSIDE POLY #1': '<a href="pools.html#riverside-poly" style="color: #0077be; text-decoration: none; font-weight: bold;">RIVERSIDE POLY #1</a>',
                'RIVERSIDE POLY #2': '<a href="pools.html#riverside-poly" style="color: #0077be; text-decoration: none; font-weight: bold;">RIVERSIDE POLY #2</a>',
                'RAMONA HS': '<a href="pools.html#ramona" style="color: #0077be; text-decoration: none; font-weight: bold;">RAMONA HS</a>',
                'NORCO HS': '<a href="pools.html#norco" style="color: #0077be; text-decoration: none; font-weight: bold;">NORCO HS</a>',
                'CHINO HILLS HS': '<a href="pools.html#chino-hills" style="color: #0077be; text-decoration: none; font-weight: bold;">CHINO HILLS HS</a>'
            };
            
            return venueLinks[venue] || venue;
        }

        // Function to extract clean team name (remove prefixes like "A1 -", "E1 -1st A -", etc.)
        function extractCleanTeamName(fullTeamName) {
            if (!fullTeamName) return 'Unknown';
            
            // Handle various prefix patterns:
            // "A1 - TEAM" -> "TEAM"
            // "E1 -1st A - TEAM" -> "TEAM" 
            // "M1 - 1st E - TEAM" -> "TEAM"
            const patterns = [
                /^[A-Z]+\d+\s*-\s*\d+\w+\s+[A-Z]+\s*-\s*(.+)$/, // "E1 -1st A - TEAM"
                /^[A-Z]+\d+\s*-\s*\d+\w+\s+[A-Z]+\d+\s*-\s*(.+)$/, // "M1 - 1st E1 - TEAM"  
                /^[A-Z]+\d+\s*-\s*(.+)$/, // "A1 - TEAM"
                /^.+\s+-\s+(.+)$/ // Generic "PREFIX - TEAM"
            ];
            
            for (const pattern of patterns) {
                const match = fullTeamName.trim().match(pattern);
                if (match) {
                    return match[1].trim();
                }
            }
            
            // If no pattern matches, return the original name
            return fullTeamName.trim();
        }

        // Function to show matches for a pool team
        function showPoolTeamMatches(teamName) {
            if (!tournamentData || !tournamentData.matches) {
                console.error('Tournament data not available');
                return;
            }

            // Filter matches for this team (handle team names with prefixes like "A1 - TEAM", "E1 -1st A - TEAM", etc.)
            const teamMatches = tournamentData.matches.filter(match => {
                const whiteTeamName = match.white_team.name.replace(/\s+/g, ' ').trim();
                const darkTeamName = match.dark_team.name.replace(/\s+/g, ' ').trim();
                const searchTeamName = teamName.replace(/\s+/g, ' ').trim();
                
                // Check if team name appears at the end (after any prefixes)
                return whiteTeamName.endsWith(searchTeamName) || darkTeamName.endsWith(searchTeamName) ||
                       whiteTeamName === searchTeamName || darkTeamName === searchTeamName;
            });

            if (teamMatches.length === 0) {
                console.log('Available team names in matches:', tournamentData.matches.map(m => [m.white_team.name, m.dark_team.name]));
                console.log('Searching for:', teamName);
                alert(`No matches found for ${teamName}. Check console for debug info.`);
                return;
            }

            // Create and show modal
            createTeamMatchesModal(teamName, teamMatches);
        }

        // Function to create team matches modal
        function createTeamMatchesModal(teamName, matches) {
            const modal = document.getElementById('teamMatchesModal');
            const modalTeamName = document.getElementById('modalTeamName');
            const teamMatchesList = document.getElementById('teamMatchesList');

            // Set team name in modal header
            modalTeamName.textContent = `${teamName} - Tournament Matches`;

            // Sort matches by match_id (chronological order)
            matches.sort((a, b) => a.match_id - b.match_id);

            // Group matches by phase
            const groupedMatches = {};
            matches.forEach(match => {
                const phase = match.phase;
                if (!groupedMatches[phase]) {
                    groupedMatches[phase] = [];
                }
                groupedMatches[phase].push(match);
            });

            // Generate matches HTML
            let matchesHTML = '';
            
            Object.entries(groupedMatches).forEach(([phase, phaseMatches]) => {
                matchesHTML += `
                    <div style="margin-bottom: 25px;">
                        <h4 style="color: #0077be; margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #0077be;">
                            ${phase} (${phaseMatches.length} match${phaseMatches.length > 1 ? 'es' : ''})
                        </h4>
                        <div style="display: grid; gap: 12px;">
                `;

                phaseMatches.forEach(match => {
                    // Check which team matches (handle prefixed names)
                    const whiteTeamName = match.white_team.name.replace(/\s+/g, ' ').trim();
                    const darkTeamName = match.dark_team.name.replace(/\s+/g, ' ').trim();
                    const searchTeamName = teamName.replace(/\s+/g, ' ').trim();
                    
                    const isTeam1 = whiteTeamName.endsWith(searchTeamName) || whiteTeamName === searchTeamName;
                    const isTeam2 = darkTeamName.endsWith(searchTeamName) || darkTeamName === searchTeamName;
                    
                    // Extract clean opponent name (remove prefixes)
                    let opponent;
                    if (isTeam1) {
                        opponent = extractCleanTeamName(match.dark_team.name);
                    } else if (isTeam2) {
                        opponent = extractCleanTeamName(match.white_team.name);
                    } else {
                        opponent = 'Unknown';
                    }
                    
                    // Get team and opponent scores
                    let teamScore = 'TBD';
                    let opponentScore = 'TBD';
                    if (match.status === 'COMPLETED' && match.white_score !== null && match.dark_score !== null) {
                        if (isTeam1) {
                            teamScore = match.white_score;
                            opponentScore = match.dark_score;
                        } else if (isTeam2) {
                            teamScore = match.dark_score;
                            opponentScore = match.white_score;
                        }
                    }
                    
                    const matchDate = match.date || 'TBD';
                    const matchTime = match.time || 'TBD';
                    const venue = getVenueLink(match.venue) || 'TBD';
                    
                    // Format videos for modal
                    let modalVideosDisplay = '';
                    if (match.videos && match.videos.length > 0) {
                        modalVideosDisplay = `
                            <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;">
                                <div style="font-size: 0.8rem; color: #666; margin-bottom: 5px;">üìπ Match Videos:</div>
                                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                    ${match.videos.map(video => 
                                        `<a href="${video.url}" target="_blank" rel="noopener noreferrer" 
                                           style="display: inline-block; background: #dc2626; color: white; padding: 4px 8px; 
                                                  border-radius: 4px; text-decoration: none; font-size: 0.8rem; 
                                                  font-weight: bold; transition: background 0.2s;" 
                                           onmouseover="this.style.background='#b91c1c'" 
                                           onmouseout="this.style.background='#dc2626'" 
                                           title="${video.title}">${video.quarter}</a>`
                                    ).join('')}
                                </div>
                            </div>`;
                    }
                    
                    matchesHTML += `
                        <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #ddd; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="display: grid; grid-template-columns: auto 1fr auto; gap: 15px; align-items: center;">
                                <div style="text-align: center; min-width: 60px;">
                                    <div style="font-size: 0.9rem; color: #666;">${matchDate}</div>
                                    <div style="font-size: 0.9rem; color: #666;">${matchTime}</div>
                                </div>
                                <div>
                                    <div style="font-weight: bold; margin-bottom: 5px;">
                                        <span style="color: ${(isTeam1 || isTeam2) ? '#0077be' : '#333'};">${teamName}</span>
                                        <span style="margin: 0 10px;">vs</span>
                                        <span style="color: #333;">${opponent}</span>
                                    </div>
                                    <div style="font-size: 0.9rem; color: #666;">
                                        üìç ${venue}
                                    </div>
                                    ${modalVideosDisplay}
                                </div>
                                <div style="text-align: center; min-width: 80px;">
                                    <div style="font-size: 1.1rem; font-weight: bold; color: ${match.status === 'COMPLETED' ? '#d32f2f' : '#0077be'};">
                                        ${teamScore} - ${opponentScore}
                                    </div>
                                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">
                                        Game ${match.match_id}
                                    </div>
                                    <div style="font-size: 0.7rem; color: ${match.status === 'COMPLETED' ? '#388e3c' : '#1976d2'}; margin-top: 2px;">
                                        ${match.status}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });

                matchesHTML += `
                        </div>
                    </div>
                `;
            });

            // Add summary info at the top
            const summaryHTML = `
                <div style="background: linear-gradient(135deg, #0077be, #00a8cc); color: white; padding: 20px; border-radius: 8px; margin-bottom: 25px; text-align: center;">
                    <h3 style="margin: 0 0 10px 0;">${teamName}</h3>
                    <p style="margin: 0; opacity: 0.9;">Total Matches: ${matches.length} | Tournament: US Club Championship</p>
                </div>
            `;

            teamMatchesList.innerHTML = summaryHTML + matchesHTML;

            // Show modal
            modal.style.display = 'block';
        }

        // Function to set up event listeners after pools are loaded
        function setupTeamClickListeners() {
            const clickableTeams = document.querySelectorAll('.clickable-pool-team');
            clickableTeams.forEach(teamElement => {
                teamElement.addEventListener('click', function() {
                    const teamName = this.dataset.team;
                    showPoolTeamMatches(teamName);
                });
                
                // Add hover effect
                teamElement.addEventListener('mouseenter', function() {
                    this.style.backgroundColor = '#e3f2fd';
                });
                teamElement.addEventListener('mouseleave', function() {
                    this.style.backgroundColor = '';
                });
            });
        }

        // Function to set up modal close functionality
        function setupModalCloseListeners() {
            const modal = document.getElementById('teamMatchesModal');
            const closeBtn = modal.querySelector('.close');

            // Close modal when X is clicked
            closeBtn.addEventListener('click', function() {
                modal.style.display = 'none';
            });

            // Close modal when clicking outside of it
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });

            // Close modal when Escape key is pressed
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && modal.style.display === 'block') {
                    modal.style.display = 'none';
                }
            });
        }



        // Load data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadTournamentData();
            
            // Set up modal close listeners
            setupModalCloseListeners();
            
            // Set up team click listeners after a short delay to ensure pools are loaded
            setTimeout(setupTeamClickListeners, 500);
            
            // Initialize collapsible functionality (matches script.js implementation)
            const collapsibles = document.querySelectorAll('.collapsible');
            collapsibles.forEach(collapsible => {
                collapsible.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const content = this.nextElementSibling;
                    content.classList.toggle('active');
                });
            });
        });
    </script>

    <!-- Team Matches Modal -->
    <div id="teamMatchesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTeamName">Team Matches</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="teamMatchesList"></div>
            </div>
        </div>
    </div>

    <script src="calendar.js"></script>
    <script src="core.js" defer></script>
    <script src="tournament.js" defer></script>
    <script src="interactive.js" defer></script>
</body>
</html>